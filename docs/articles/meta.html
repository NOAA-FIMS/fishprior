<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meta-analyses with the fishprior R package • fishprior</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Meta-analyses with the fishprior R package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fishprior</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">Demonstration of the fishprior R package</a>
    </li>
    <li>
      <a href="../articles/meta.html">Meta-analyses with the fishprior R package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/noaa-fims/fishprior/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Meta-analyses with the fishprior R package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-fims/fishprior/blob/HEAD/vignettes/meta.Rmd" class="external-link"><code>vignettes/meta.Rmd</code></a></small>
      <div class="hidden name"><code>meta.Rmd</code></div>

    </div>

    
    
<p>The vignette provides a slightly more complicated example of how to
use the fishprior package to combine parameters into a meta-analysis.
The <code><a href="../reference/summarize_fishbase_traits.html">summarize_fishbase_traits()</a></code> function produces summary
statistics across studies, weighting estimates equally and ignoring
sample sizes or standard errors of estimates. We provide two case
studies below, first examining maximum length of European mackerel
(weighting studies by sample size), and second examining growth rates of
sablefish (weighting studies by standard errors).</p>
<p>FishBase includes sample sizes (<code>Number</code>) and standard
errors (<code>SE</code>) when available, however these may not be
available for most records, and there may be variability in reporting by
species or trait type. For full details, see the following tables</p>
<table class="table">
<thead><tr class="header">
<th align="left">FishBase.tables.used</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rfishbase::popgrowth</td>
</tr>
<tr class="even">
<td align="left">rfishbase::popchar</td>
</tr>
<tr class="odd">
<td align="left">rfishbase::poplw</td>
</tr>
<tr class="even">
<td align="left">rfishbase::maturity</td>
</tr>
<tr class="odd">
<td align="left">rfishbase::fecundity</td>
</tr>
</tbody>
</table>
<div class="section level2">
<h2 id="combining-estimates-using-sample-sizes">Combining estimates using sample sizes<a class="anchor" aria-label="anchor" href="#combining-estimates-using-sample-sizes"></a>
</h2>
<p>To illustrate how point estimates may combined in a more traditional
meta-analysis, we’ll use data from the European mackerel (<em>Scomber
scombrus</em>). Data can be obtained from FishBase using
<code><a href="../reference/get_fishbase_traits.html">get_fishbase_traits()</a></code> – more detailed information is in the
introductory vignette. We will focus this example on maximum length
(<code>LengthMax</code>) because it is one of the variables in
<code><a href="https://docs.ropensci.org/rfishbase/reference/length_weight.html" class="external-link">rfishbase::poplw()</a></code> that has an associated sample size, but
not standard error.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Scomber scombrus"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">example_base_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fishbase_traits.html">get_fishbase_traits</a></span><span class="op">(</span>spec_names <span class="op">=</span> <span class="va">species_list</span><span class="op">)</span></span>
<span><span class="va">example_base_raw</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 285 × 22</span></span></span>
<span><span class="co">##    rfishbase Species          SpecCode Sex   PopGrowthRef DataSourceRef Locality</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> popgrowth Scomber scombrus      118 unse…          207            <span style="color: #BB0000;">NA</span> Northwe…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> popgrowth Scomber scombrus      118 unse…          207            <span style="color: #BB0000;">NA</span> Northwe…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> popgrowth Scomber scombrus      118 unse…          207            <span style="color: #BB0000;">NA</span> Northwe…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> popgrowth Scomber scombrus      118 unse…          207            <span style="color: #BB0000;">NA</span> Northwe…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> popgrowth Scomber scombrus      118 unse…          207            <span style="color: #BB0000;">NA</span> Northwe…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> popgrowth Scomber scombrus      118 unse…          312          <span style="text-decoration: underline;">1</span>208 ICNAF S…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> popgrowth Scomber scombrus      118 unse…          312          <span style="text-decoration: underline;">1</span>208 ICNAF S…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> popgrowth Scomber scombrus      118 unse…          312          <span style="text-decoration: underline;">1</span>208 ICNAF S…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> popgrowth Scomber scombrus      118 unse…          312          <span style="text-decoration: underline;">1</span>208 ICNAF S…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> popgrowth Scomber scombrus      118 unse…          312          <span style="text-decoration: underline;">1</span>207 New Eng…</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 275 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more variables: YearStart &lt;int&gt;, YearEnd &lt;int&gt;, Number &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Type &lt;chr&gt;, C_Code &lt;chr&gt;, E_CODE &lt;dbl&gt;, SourceRef &lt;int&gt;, StockCode &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   AgeMatRef &lt;int&gt;, trait &lt;chr&gt;, value &lt;dbl&gt;, SE &lt;dbl&gt;, SD &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   country &lt;chr&gt;, EcosystemName &lt;chr&gt;</span></span></span></code></pre>
<p>There are differences in reporting between <code>Number</code> and
<code>SE</code>, with fewer studies having standard errors reported.
There may be some rounding or reporting issues with <code>SE</code>,
because at least one of the values is 0. There’s quite a bit of
variation by trait type, with estimates from studies estimating
length-weight regressions reporting <code>Number</code> more commonly
than other studies,</p>
<p><img src="meta_files/figure-html/n-table-1.png" width="700"></p>
<p>We will filter out studies that don’t report <code>Number</code>, but
an alternative approach would be to set the <code>Number</code> for
these studies to some small value (the smallest reported across all
studies, or 1, etc)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filtered_traits</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">example_base_raw</span>,</span>
<span>                                 <span class="va">Number</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                                 <span class="va">trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LengthMax"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="variance-weighting">Variance weighting<a class="anchor" aria-label="anchor" href="#variance-weighting"></a>
</h3>
<p>The first way to combine estimates is by applying variance weighting.
To do this, we use <code>Number</code> as the weights for the weighted
mean and variance,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weighted_summary</span> <span class="op">&lt;-</span> <span class="va">filtered_traits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    weighted_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">value</span>, w <span class="op">=</span> <span class="va">Number</span><span class="op">)</span>,</span>
<span>    simple_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    weighted_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Number</span> <span class="op">*</span> <span class="op">(</span><span class="va">value</span> <span class="op">-</span> <span class="va">weighted_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Number</span><span class="op">)</span>,</span>
<span>    weighted_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">weighted_var</span> <span class="op">/</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    total_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Number</span><span class="op">)</span>,</span>
<span>    n_studies <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">weighted_summary</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">##   weighted_mean simple_mean weighted_var weighted_se total_n n_studies</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          45.1        42.0         4.57       0.347   <span style="text-decoration: underline;">61</span>267        38</span></span></code></pre>
<p>The vertical blue lines here represent the weighted mean (and 95%
confidence intervals); the weighted mean is slightly larger than the
simple mean (42).</p>
<pre><code><span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre>
<p><img src="meta_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="model-based-weighting">Model based weighting<a class="anchor" aria-label="anchor" href="#model-based-weighting"></a>
</h3>
<p>Without the reported study specific standard errors, it is difficult
to do a true meta-analysis. However we can estimate a common mean and
observation variance, which is another way to use the sample sizes as
weights. The reported mean length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">y_i</annotation></semantics></math>
can be assumed to be an observation of the true study-specific
unobserved mean length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\theta_i</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
represents the variance across studies,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><mfrac><mi>σ</mi><msqrt><msub><mi>n</mi><mi>i</mi></msub></msqrt></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_i \sim Normal(\theta_i, \frac{\sigma}{\sqrt{n_i}})</annotation></semantics></math>
and then the random effects can be estimated with a common
hyperparameters</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_i \sim Normal(\mu, \tau)</annotation></semantics></math></p>
<p>To fit this model in <code>brms</code>, we can use the following
code. Because maximum size can be skewed, we’ll fit the model in log
space,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="va">filtered_traits</span><span class="op">$</span><span class="va">sqrt_n</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">filtered_traits</span><span class="op">$</span><span class="va">Number</span><span class="op">)</span></span>
<span><span class="va">filtered_traits</span><span class="op">$</span><span class="va">study_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">filtered_traits</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">filtered_traits</span><span class="op">$</span><span class="va">log_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">filtered_traits</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">log_n</span> <span class="op">~</span> <span class="va">theta</span>,</span>
<span>  <span class="va">theta</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study_id</span><span class="op">)</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">sqrt_n</span>,</span>
<span>  nl <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">filtered_traits</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">5000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combining-estimates-using-meta-analysis">Combining estimates using meta-analysis<a class="anchor" aria-label="anchor" href="#combining-estimates-using-meta-analysis"></a>
</h2>
<p>For cases where the standard errors exist, a second approach is to do
a true meta-analysis and use the standard errors as weights. For this
example, we’ll focus a meta-analysis on the growth coefficient
(<code>k</code>) of sablefish (<em>Anoplopoma fimbria</em>)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Anoplopoma fimbria"</span><span class="op">)</span></span>
<span><span class="va">sablefish_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_fishbase_traits.html">get_fishbase_traits</a></span><span class="op">(</span>spec_names <span class="op">=</span> <span class="va">species_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">filtered_traits</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sablefish_traits</span>,</span>
<span>                                 <span class="va">SE</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                                 <span class="va">trait</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There’s a small number of studies here from 2 regions in the Pacific
Ocean, and if we look at breakdown by region, there seems to be
substantially smaller values in Alaska.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Locality</th>
<th align="right">value</th>
<th align="right">SE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">West coast</td>
<td align="right">0.499</td>
<td align="right">0.047</td>
</tr>
<tr class="even">
<td align="left">West coast</td>
<td align="right">0.481</td>
<td align="right">0.083</td>
</tr>
<tr class="odd">
<td align="left">Gulf of Alaska</td>
<td align="right">0.117</td>
<td align="right">0.024</td>
</tr>
<tr class="even">
<td align="left">Gulf of Alaska</td>
<td align="right">0.106</td>
<td align="right">0.008</td>
</tr>
<tr class="odd">
<td align="left">West coast</td>
<td align="right">0.472</td>
<td align="right">0.055</td>
</tr>
<tr class="even">
<td align="left">West coast</td>
<td align="right">0.556</td>
<td align="right">0.108</td>
</tr>
<tr class="odd">
<td align="left">Gulf of Alaska</td>
<td align="right">0.120</td>
<td align="right">0.140</td>
</tr>
<tr class="even">
<td align="left">Gulf of Alaska</td>
<td align="right">0.126</td>
<td align="right">0.044</td>
</tr>
</tbody>
</table>
<p>It probably makes more sense for interpretation and estimation to
focus on a single region, so we will only use estimates from Alaska</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ak_traits</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">filtered_traits</span>,</span>
<span>                                 <span class="va">Locality</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gulf of Alaska"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The model here can be written as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo>,</mo><msub><mtext mathvariant="normal">SE</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_i \sim Normal(\theta_i, \text{SE}_i)</annotation></semantics></math>
where and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub><mo>∼</mo><mi>N</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>l</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_i \sim Normal(\mu, \tau)</annotation></semantics></math></p>
<p>where the major contrast to above is not assuming a population level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>,
and instead providing the standard error value directly.</p>
<p>An advantage of this approach is that it takes advantages of brms’
existing machinery for doing meta-analyses and using the <code>SE</code>
directly in the <code>se()</code> function</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ak_traits</span><span class="op">$</span><span class="va">study</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ak_traits</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">SE</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ak_traits</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kelli F. Johnson, Jennifer S. Bigman,, Eric J. Ward.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
